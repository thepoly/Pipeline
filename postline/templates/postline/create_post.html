{% extends "wagtailadmin/base.html" %}
{% load static wagtailadmin_tags %}

{% block content %}
    <form method="post" class="w-form" id="create-post-form">
        {% csrf_token %}
        
        {% if has_paragraphs %}
        <div class="form-box">
            <div class="w-field-group">
                <!-- Checkbox: Add All Paragraphs -->
                <div class="checkbox-group">
                    <input 
                        type="checkbox" 
                        id="{{ form.add_all_paragraphs.id_for_label }}" 
                        name="{{ form.add_all_paragraphs.name }}" 
                        class="checkbox-input"
                        {% if form.add_all_paragraphs.value %}checked{% endif %}
                    >
                    <label for="{{ form.add_all_paragraphs.id_for_label }}" class="checkbox-label">
                        {{ form.add_all_paragraphs.label }}
                    </label>
                </div>
        
                <!-- Checkbox: Generate Title Image -->
                <div class="title-text-group">
                    <!-- Title Page Checkbox -->
                    <div class="checkbox-group">
                        <input 
                            type="checkbox" 
                            id="{{ form.generate_title_image.id_for_label }}" 
                            name="{{ form.generate_title_image.name }}" 
                            class="checkbox-input"
                            {% if form.generate_title_image.value %}checked{% endif %}
                        >
                        <label for="{{ form.generate_title_image.id_for_label }}" class="checkbox-label">
                            {{ form.generate_title_image.label }}
                        </label>
                    </div>
                
                    <!-- Add Extra Text Input -->
                    <div class="extra-text-group">
                        <label for="{{ form.extra_text.id_for_label }}" class="form-text">
                            {{ form.extra_text.label }}
                        </label>
                        <input 
                            type="text" 
                            id="{{ form.extra_text.id_for_label }}" 
                            name="{{ form.extra_text.name }}" 
                            class="text-input extra-text-input" 
                            value="{{ form.extra_text.value|default:'' }}"
                        >
                    </div>
                </div>
        
                <!-- Dropdown: Position Extra Text -->
                <div class="extra-text-position-group">
                    <label for="{{ form.extra_text_position.id_for_label }}" class="form-text">Position</label>
                    {{ form.extra_text_position }}
                </div>
            </div>
        </div>

            <!-- Paragraph Selection -->
            <div class="form-box">
                <div class="paragraph-box-container">
                    {% for choice in form.paragraph.field.choices %}
                    <div class="paragraph-box">
                        <input 
                            type="checkbox" 
                            id="id_paragraph_{{ forloop.counter }}" 
                            name="paragraph" 
                            value="{{ choice.0 }}" 
                            class="checkbox-input"
                        >
                        <label for="id_paragraph_{{ forloop.counter }}" class="checkbox-label">
                            {{ choice.1 }}
                        </label>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Generate Button -->
            <div class="test">
                <button type="submit" class="button generate-button">Generate</button>
                <a href="{% url 'postline:display_articles_table' %}" class="button button-secondary">
                    <i class="fas fa-arrow-left"></i> Return
                </a>
            </div>
        {% else %}
            <!-- Message when there are no paragraphs -->
            <div class="no-paragraphs-message">
                This article does not contain any paragraphs.
            </div>
            <div class="test">
                <a href="{% url 'postline:display_articles_table' %}" class="button button-secondary">
                    <i class="fas fa-arrow-left"></i> Return
                </a>
            </div>
        {% endif %}
    </form>

    <!-- Display Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
{% endblock %}

{% block extra_js %}
    <script>
        window.paragraphName = "{{ form.paragraph.name }}";
        window.addAllParagraphsId = "{{ form.add_all_paragraphs.auto_id }}";
        window.generateTitleImageId = "{{ form.generate_title_image.auto_id }}";
        window.extraTextId = "{{ form.extra_text.auto_id }}";
        window.extraTextPositionId = "{{ form.extra_text_position.auto_id }}";
    </script>
    <script src="{% static 'js/create_post.js' %}"></script>
{% endblock %}

{% block extra_css %}
    <!-- Reference the external CSS file -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/create_post.css' %}">
    <link rel="stylesheet" href="{% static 'fontawesome/css/all.min.css' %}">
{% endblock %}
